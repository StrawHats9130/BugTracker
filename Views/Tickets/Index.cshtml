@using BugTracker.Helpers

@model IEnumerable<TicketIndexViewModel>

@{
    ViewBag.Title = "Index";
}

<div class="content-wrapper">
    <h2>Index</h2>

    <p>
        @Html.ActionLink("Create New", "Create")
    </p>

    <!-- original Scafold taable-->
    <section>
        @*<table class="table">
            <tr>
                <th>
                    @Html.DisplayName("Developer")
                </th>
                <th>
                        @Html.DisplayName("Project")
                    </th>
                <th>
                    // check End of Allison (maybe Video11) for how to display this as is and not hard coded string.drew says it.
                    @Html.DisplayNameFor(model => model.Ticket.Submitter.FullName)
                </th>
                <th>
                    @Html.DisplayName("Priority")
                </th>
                <th>
                    @Html.DisplayName("Status")
                </th>
                <th>
                    @Html.DisplayName("Text Status")
                </th>
                <th>
                    @Html.DisplayName("Type")
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Ticket.Title)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Ticket.Description)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Ticket.Created)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Ticket.Updated)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Ticket.IsArchived)
                </th>
                <th></th>
            </tr>

            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Ticket.Developer.FirstName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Ticket.Project.Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Ticket.Submitter.FirstName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Ticket.TicketTypeId)
                    </td>
                    <td class="@colorHelper.GetStatusColorClass2(item.Ticket.TicketStatus.Name)">
                        @Html.DisplayFor(modelItem => item.Ticket.TicketStatus.Name)
                    </td>
                    <td class="@colorHelper.GetStatusColorClass2(item.Ticket.TicketStatus.Name)">
                        @using (Html.BeginForm("SpecialEdit", "Tickets"))
                        {
                            @Html.AntiForgeryToken()
                            @Html.Hidden("TicketId", item.Ticket.Id)

                            <div class=" row">
                                <div class=" col">
                                    @Html.DropDownList("TicketStatusId", item.TicketStatus)
                                </div>
                            </div>
                            <div class=" row">
                                <div class=" col">
                                    <button type="submit" class="btn btn-outline-dark btn-sm">Save</button>
                                </div>
                            </div>

                        }


                    </td>

                    <td>
                        @Html.DisplayFor(modelItem => item.Ticket.TicketPriorityId)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Ticket.Title)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Ticket.Description)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Ticket.Created)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Ticket.Updated)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Ticket.IsArchived)
                    </td>
                    <td>
                        @if (User.IsInRole("Admin") || User.IsInRole("PM"))
                        {
                            @Html.ActionLink("Edit", "Edit", new { id = item.Ticket.Id })
                            @Html.ActionLink("Delete", "Delete", new { id = item.Ticket.Id })
                        }
                        @Html.ActionLink("Details", "Details", new { id = item.Ticket.Id })
                    </td>
                </tr>
            }

        </table>*@
    </section>

    <!-- TABLE: LATEST ORDERS -->
    <div class="card">
        <div class="card-header border-transparent">
            <h3 class="card-title">Current Tickets</h3>

            <div class="card-tools">
                <button type="button" class="btn btn-tool" data-card-widget="collapse">
                    <i class="fas fa-minus"></i>
                </button>
                @*<button type="button" class="btn btn-tool" data-card-widget="remove">
                        <i class="fas fa-times"></i>
                    </button>*@
            </div>
        </div>

        <!-- /.card-header -->
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table m-0">
                    <thead>
                        <tr>
                            <th>
                                @Html.DisplayNameFor(model => model.Ticket.Title)
                            </th>
                            <th>
                                @Html.DisplayName("Developer")
                            </th>
                            <th> @Html.DisplayName("Status")</th>
                            <th> @Html.DisplayName("Status")</th>
                            <th> @Html.DisplayNameFor(model => model.Ticket.Created)</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td> @Html.DisplayFor(modelItem => item.Ticket.Title)</td>
                                <td> @Html.DisplayFor(modelItem => item.Ticket.Developer.FirstName)</td>
                                <td><span class="badge badge-warning">@Html.DisplayFor(modelItem => item.Ticket.TicketStatus.Name)</span></td>
                                <td>
                                    @using (Html.BeginForm("SpecialEdit", "Tickets"))
                                    {
                                        @Html.AntiForgeryToken()
                                        @Html.Hidden("TicketId", item.Ticket.Id)

                                        <div class=" row">
                                            <div class=" col">
                                                @Html.DropDownList("TicketStatusId", item.TicketStatus)
                                            </div>
                                            <div class=" col">
                                                <button type="submit" class="btn btn-outline-dark btn-sm">Save</button>
                                            </div>
                                        </div>


                                    }
                                </td>
                                <td> @Html.DisplayFor(modelItem => item.Ticket.Created)</td>
                                <td>
                                    @if (User.IsInRole("Admin") || User.IsInRole("PM"))
                                    {
                                        @Html.ActionLink("Edit", "Edit", new { id = item.Ticket.Id })
                                        @*@Html.ActionLink("Delete", "Delete", new { id = item.Ticket.Id })*@
                                    }
                                    | @Html.ActionLink("Details", "Details", new { id = item.Ticket.Id })
                                    | @Html.ActionLink("Dashboard", "Dashboard", new { id = item.Ticket.Id })
                                </td>

                            </tr>
                        }
                        @*<tr>
                                <td><a href="pages/examples/invoice.html">OR1848</a></td>
                                <td>Samsung Smart TV</td>
                                <td><span class="badge badge-warning">Pending</span></td>
                                <td>
                                    <div class="sparkbar" data-color="#f39c12" data-height="20">90,80,-90,70,61,-83,68</div>
                                </td>
                                <td></td>
                            </tr>*@

                    </tbody>
                </table>
            </div>
            <!-- /.table-responsive -->
        </div>
        <!-- /.card-body -->
        @*<div class="card-footer clearfix">
                <a href="javascript:void(0)" class="btn btn-sm btn-info float-left">Place New Order</a>
                <a href="javascript:void(0)" class="btn btn-sm btn-secondary float-right">View All Orders</a>
            </div>*@
        <!-- /.card-footer -->
    </div>
    <!-- /.card -->
</div>